<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="ููุชุจุชู">
  <meta name="theme-color" content="#0f0f1a">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" sizes="192x192" href="icon-192.png">
  <link rel="apple-touch-icon" sizes="512x512" href="icon-512.png">
  <title>ููุชุจุชู ุงูุดุฎุตูุฉ</title>
  <link rel="stylesheet" href="css/app.css">
</head>
<body>

<!-- ==================== VIEW: LIBRARY ==================== -->
<div id="view-library" class="view active">

  <!-- Library Header -->
  <div class="library-header">
    <div class="header-top">
      <h1 class="app-title">๐ ููุชุจุชู</h1>
      <div id="streak-badge" class="streak-badge">
        <span class="streak-fire">๐ฅ</span>
        <span class="streak-count">0</span>
      </div>
    </div>
    <p class="app-subtitle">ููุฎุตุงุช ุงููุชุจ ุจุงููุบุฉ ุงูุนุฑุจูุฉ</p>
    <span class="book-count" id="book-count">17 ูุชุงุจ</span>
  </div>

  <!-- Search -->
  <div class="search-container">
    <input type="search" id="search-input" class="search-input" placeholder="๐ ุงุจุญุซ ุนู ูุชุงุจ ุฃู ูุคูู..." autocomplete="off">
  </div>

  <!-- Filter Tabs -->
  <div class="filter-tabs" id="filter-tabs">
    <button class="filter-tab active" data-filter="all">ุงููู</button>
    <button class="filter-tab" data-filter="unread">ูู ูููุฑุฃ</button>
    <button class="filter-tab" data-filter="reading">ููุฏ ุงููุฑุงุกุฉ</button>
    <button class="filter-tab" data-filter="completed">ููุชูู โ</button>
  </div>

  <!-- Books Grid (populated by JS) -->
  <div id="books-grid" class="books-grid"></div>

</div>

<!-- ==================== VIEW: READER ==================== -->
<div id="view-reader" class="view">

  <!-- Reader Header -->
  <div class="reader-header">
    <button id="btn-close-reader" class="reader-btn">โ</button>
    <span id="reader-title" class="reader-title-text">...</span>
    <div class="reader-actions">
      <button id="btn-toc" class="reader-btn" title="ุงูููุฑุณ">โฐ</button>
      <button id="btn-bookmark" class="reader-btn" title="ุฅุถุงูุฉ ุนูุงูุฉ">๐</button>
      <button id="btn-font-settings" class="reader-btn" title="ุฎุท">Aa</button>
    </div>
  </div>

  <!-- Reading Progress Bar -->
  <div class="reader-progress-container">
    <div id="reader-progress" class="reader-progress-bar"></div>
  </div>

  <!-- Book Content (iframe) -->
  <iframe id="book-frame" class="book-frame" src="" sandbox="allow-same-origin allow-scripts"></iframe>

  <!-- Reader Toolbar (slides up) -->
  <div id="reader-toolbar" class="reader-toolbar">
    <div class="toolbar-section">
      <h4>ุญุฌู ุงูุฎุท</h4>
      <div class="font-size-control">
        <button class="font-btn" data-action="decrease">ุฃ-</button>
        <span id="font-size-display">16</span>
        <button class="font-btn" data-action="increase">ุฃ+</button>
      </div>
    </div>
    <div class="toolbar-section">
      <h4>ููุน ุงูุฎุท</h4>
      <div class="font-family-options">
        <button class="font-family-btn active" data-font="Tajawal">ุชุฌูุงู</button>
        <button class="font-family-btn" data-font="Amiri">ุฃููุฑู</button>
        <button class="font-family-btn" data-font="Noto Naskh Arabic">ูุณุฎ</button>
      </div>
    </div>
    <div class="toolbar-section">
      <h4>ุชูุจูุฑ / ุชุตุบูุฑ</h4>
      <div class="zoom-control">
        <button class="zoom-btn" data-action="zoom-out">โ</button>
        <span id="zoom-display">100%</span>
        <button class="zoom-btn" data-action="zoom-in">+</button>
      </div>
    </div>
    <div class="toolbar-section">
      <h4>ููู ุงูุชุธููู</h4>
      <div class="highlight-colors">
        <button class="color-dot active" data-color="yellow" style="background:#FFEB3B"></button>
        <button class="color-dot" data-color="green" style="background:#4CAF50"></button>
        <button class="color-dot" data-color="blue" style="background:#2196F3"></button>
        <button class="color-dot" data-color="pink" style="background:#E91E63"></button>
        <button class="color-dot" data-color="orange" style="background:#FF9800"></button>
      </div>
    </div>
  </div>

  <!-- Highlight Color Bar (shown when highlight mode active) -->
  <div id="highlight-bar" class="highlight-bar hidden">
    <span>ูุถุน ุงูุชุธููู ููุนูู</span>
    <button id="btn-exit-highlight">โ ุฅูุบุงุก</button>
  </div>
</div>

<!-- ==================== VIEW: DASHBOARD ==================== -->
<div id="view-dashboard" class="view">
  <div class="view-header">
    <h2>๐ ููุญุฉ ุงููุฑุงุกุฉ</h2>
  </div>

  <div id="streak-section" class="dashboard-section">
    <!-- Streak calendar and stats rendered by JS -->
  </div>

  <div id="stats-section" class="dashboard-section">
    <!-- Reading stats cards rendered by JS -->
  </div>

  <div id="category-chart" class="dashboard-section">
    <!-- Category breakdown rendered by JS -->
  </div>

  <div id="mind-map-section" class="dashboard-section">
    <!-- Author connections mind map rendered by JS -->
  </div>
</div>

<!-- ==================== VIEW: QUOTES ==================== -->
<div id="view-quotes" class="view">
  <div class="view-header">
    <h2>๐ฌ ุงูุงูุชุจุงุณุงุช ูุงูููุงุญุธุงุช</h2>
  </div>

  <div class="quotes-tabs" id="quotes-tabs">
    <button class="quotes-tab active" data-tab="highlights">ุงูุชุจุงุณุงุช</button>
    <button class="quotes-tab" data-tab="comments">ุชุนูููุงุช</button>
    <button class="quotes-tab" data-tab="bookmarks">ุนูุงูุงุช</button>
  </div>

  <div id="quotes-content" class="quotes-content">
    <!-- Rendered by JS -->
  </div>
</div>

<!-- ==================== VIEW: ACTIONS ==================== -->
<div id="view-actions" class="view">
  <div class="view-header">
    <h2>ุฎุทุฉ ุงูุชุทุจูู</h2>
  </div>
  <div id="actions-content">
    <!-- Rendered by JS -->
  </div>
</div>

<!-- ==================== VIEW: SETTINGS ==================== -->
<div id="view-settings" class="view">
  <div class="view-header">
    <h2>โ๏ธ ุงูุฅุนุฏุงุฏุงุช</h2>
  </div>
  <div id="settings-content">
    <!-- Rendered by JS -->
  </div>
</div>

<!-- ==================== BOTTOM NAVIGATION ==================== -->
<nav class="bottom-nav" id="bottom-nav">
  <button class="nav-item active" data-view="library">
    <span class="nav-icon">๐</span>
    <span class="nav-label">ุงูููุชุจุฉ</span>
  </button>
  <button class="nav-item" data-view="dashboard">
    <span class="nav-icon">๐</span>
    <span class="nav-label">ููุญุฉ</span>
  </button>
  <button class="nav-item" data-view="quotes">
    <span class="nav-icon">๐ฌ</span>
    <span class="nav-label">ุงูุชุจุงุณุงุช</span>
  </button>
  <button class="nav-item" data-view="settings">
    <span class="nav-icon">โ๏ธ</span>
    <span class="nav-label">ุฅุนุฏุงุฏุงุช</span>
  </button>
</nav>

<!-- Toast Notification -->
<div id="toast" class="toast hidden"></div>

<!-- Scripts -->
<script src="js/db.js"></script>
<script src="js/sync.js"></script>
<script src="js/app.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', async () => {
    await App.init();
    // Cloud sync after init (fire-and-forget)
    if (window.CloudSync) {
      CloudSync.fullSync().then((ok) => {
        if (ok) console.log('Cloud sync done');
      });
    }
  });
</script>

</body>
</html>
